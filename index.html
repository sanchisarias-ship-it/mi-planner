<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mi Planner Saludable</title>

<style>
body { font-family:-apple-system,BlinkMacSystemFont,Arial,sans-serif; background:#f4f9ff; margin:0; }
header { background:linear-gradient(135deg,#00c6ff,#0072ff); color:#fff; padding:16px; text-align:center; }
nav { display:flex; background:#0d2b45; }
nav button { flex:1; padding:12px; color:#fff; background:#0d2b45; border:none; font-size:15px; }
nav button.active { background:#123e63; }
section { display:none; padding:14px; }
section.active { display:block; }
.card { background:#fff; padding:14px; border-radius:18px; margin-bottom:14px; box-shadow:0 4px 10px rgba(0,0,0,.06); }

.complete-btn {
  background: linear-gradient(135deg,#28a745,#5ddf7a);
  border:none;
  color:white;
  padding:10px 14px;
  border-radius:14px;
  font-weight:bold;
  width:100%;
  margin-top:10px;
}
.complete-btn.off { background:#ccc; color:#333; }

.weekdays { display:grid; grid-template-columns:repeat(7,1fr); font-weight:bold; font-size:12px; text-align:center; margin-top:10px; }
.grid { display:grid; grid-template-columns:repeat(7,1fr); gap:6px; margin-top:6px; }
.day { background:#eef3f8; padding:10px 0; border-radius:12px; font-size:13px; text-align:center; cursor:pointer; }
.day.completed { background:#a7f3b5; font-weight:bold; }
.day.today { border:2px solid #0072ff; }

#alimentosContenido h3 { margin:16px 0 6px; font-size:16px; border-bottom:1px solid #eee; padding-bottom:4px; }
#alimentosContenido ul { padding:0; margin:0 0 12px 0; }
#alimentosContenido li {
  list-style:none;
  display:flex;
  align-items:center;
  gap:8px;
  padding:6px 8px;
  border-radius:12px;
  margin-bottom:4px;
  background:#f9fcff;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
#alimentosContenido li span { flex:1; overflow:hidden; text-overflow:ellipsis; }
#alimentosContenido li.comprado { text-decoration:line-through; color:#666; background:#dffbe7; }
#alimentosContenido input[type="checkbox"] { transform:scale(1.1); }
#alimentosContenido button { background:#ffe5e5; border:none; border-radius:10px; padding:4px 8px; cursor:pointer; }
#alimentosContenido input[type="text"] { width:70%; padding:6px; border-radius:10px; border:1px solid #ddd; margin-top:4px; }
</style>
</head>
<body>

<header><h1>üö¥‚Äç‚ôÇÔ∏è Mi Planner Saludable</h1></header>

<nav>
  <button class="active" onclick="showTab('hoy',this)">Hoy</button>
  <button onclick="showTab('calendario',this)">Calendario</button>
  <button onclick="showTab('alimentos',this)">Alimentos</button>
</nav>

<section id="hoy" class="active">
  <div class="card" id="hoyContenido"></div>
</section>

<section id="calendario">
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <button onclick="prevMonth()">‚óÄ</button>
      <strong id="monthLabel"></strong>
      <button onclick="nextMonth()">‚ñ∂</button>
    </div>
    <div class="weekdays">
      <div>L</div><div>M</div><div>X</div><div>J</div><div>V</div><div>S</div><div>D</div>
    </div>
    <div id="calendar" class="grid"></div>
  </div>
  <div class="card">
    <h3 id="detailTitle">Selecciona un d√≠a</h3>
    <div id="detailContent"></div>
  </div>
</section>

<section id="alimentos">
  <div class="card" id="alimentosContenido"></div>
</section>

<script>
const DATA = {
  "2026-01-01": [{time:"08:00", summary:"Bici suave", description:"45 min zona 2"}],
  "2026-01-02": [{time:"09:00", summary:"TRX fuerza", description:"Parte superior"}]
};

const BASE = {
  "Prote√≠nas": ["Pollo","Huevos","At√∫n"],
  "Verduras": ["Br√≥coli","Tomate","Espinacas"],
  "Hidratos": ["Arroz","Avena","Patata"],
  "Grasas saludables": ["Aceite de oliva","Nueces","Aguacate"]
};

function showTab(id,btn){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  btn.classList.add("active");
}

function isCompleted(date){ return localStorage.getItem("done_"+date)==="1"; }
function toggleCompleted(date){
  if(isCompleted(date)) localStorage.removeItem("done_"+date);
  else localStorage.setItem("done_"+date,"1");
  renderHoy(); renderCalendar();
}

function renderHoy(){
  const today = new Date().toISOString().slice(0,10);
  let html = "<h2>Hoy</h2>";
  if (!DATA[today]) html += "<p>Sin eventos hoy</p>";
  else {
    html += "<ul>";
    DATA[today].forEach(e=>{
      html += "<li><b>"+e.time+"</b> - "+e.summary+"<br>"+(e.description||"")+"</li>";
    });
    html += "</ul>";
  }
  const completed = isCompleted(today);
  html += `<button class="complete-btn ${completed?"":"off"}" onclick="toggleCompleted('${today}')">
    ${completed?"‚úÖ D√≠a completado":"‚¨ú Marcar d√≠a como completado"}
  </button>`;
  document.getElementById("hoyContenido").innerHTML = html;
}

let current = new Date();
function renderCalendar(){
  const y=current.getFullYear(), m=current.getMonth();
  document.getElementById("monthLabel").innerText =
    current.toLocaleDateString("es-ES",{month:"long",year:"numeric"});
  const first=(new Date(y,m,1).getDay()+6)%7;
  const days=new Date(y,m+1,0).getDate();
  let cont=document.getElementById("calendar");
  cont.innerHTML="";
  for(let i=0;i<first;i++) cont.innerHTML+="<div></div>";
  for(let d=1;d<=days;d++){
    const key=y+"-"+String(m+1).padStart(2,"0")+"-"+String(d).padStart(2,"0");
    const completed = isCompleted(key) ? "completed" : "";
    const todayClass = key === new Date().toISOString().slice(0,10) ? "today" : "";
    cont.innerHTML+=`<div class="day ${completed} ${todayClass}" onclick="showDay('${key}')">${d}</div>`;
  }
}

function showDay(key){
  document.getElementById("detailTitle").innerText = key;
  if(!DATA[key]) { document.getElementById("detailContent").innerText="Sin eventos"; return; }
  let html="<ul>";
  DATA[key].forEach(e=>html+=`<li><b>${e.time}</b> - ${e.summary}<br>${e.description||""}</li>`);
  html+="</ul>";
  document.getElementById("detailContent").innerHTML=html;
}

function prevMonth(){ current.setMonth(current.getMonth()-1); renderCalendar(); }
function nextMonth(){ current.setMonth(current.getMonth()+1); renderCalendar(); }

function getCats(){
  if(!localStorage.getItem("cats")) localStorage.setItem("cats", JSON.stringify(BASE));
  return JSON.parse(localStorage.getItem("cats"));
}
function saveCats(c){ localStorage.setItem("cats", JSON.stringify(c)); }

function renderAlimentos(){
  const cats=getCats();
  let html="";
  for(let cat in cats){
    html+=`<h3>${cat}</h3><ul>`;
    cats[cat].forEach((item,i)=>{
      const key="check_"+item;
      const checked=localStorage.getItem(key)?"checked":"";
      const comprado=localStorage.getItem(key)?"comprado":"";
      html+=`
      <li class="${comprado}">
        <input type="checkbox" onchange="toggleCheck('${key}',this)" ${checked}>
        <span>${item}</span>
        <button onclick="removeFood('${cat}',${i})">‚ùå</button>
      </li>`;
    });
    html+=`</ul>
    <input id="in_${cat}" placeholder="A√±adir alimento">
    <button onclick="addFood('${cat}')">A√±adir</button>`;
  }
  document.getElementById("alimentosContenido").innerHTML=html;
}

function toggleCheck(key,cb){
  if(cb.checked){ localStorage.setItem(key,"1"); cb.parentElement.classList.add("comprado"); }
  else { localStorage.removeItem(key); cb.parentElement.classList.remove("comprado"); }
}

function addFood(cat){
  const cats=getCats();
  const val=document.getElementById("in_"+cat).value.trim();
  if(!val) return;
  cats[cat].push(val);
  saveCats(cats);
  renderAlimentos();
}

function removeFood(cat,i){
  const cats=getCats();
  cats[cat].splice(i,1);
  saveCats(cats);
  renderAlimentos();
}

renderHoy();
renderCalendar();
renderAlimentos();
</script>
</body>
</html>
